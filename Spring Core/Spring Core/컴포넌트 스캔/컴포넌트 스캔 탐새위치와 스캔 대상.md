# 컴포넌트 스캔이 탐색할 위치는 어떻게되는거지?

- 스프링빈 자동등록을 위해 컴포넌트 스캔방식으로 `@Component`가 붙은 클래스를 스프링 빈으로 등록했다.
- 탐색위치는 어떻게 정해서 탐색하는걸까?
- `@ComponentScan` 의 basePackages로 탐색 위치 범위를 지정할수있는데 default는 `@CopmonentScan`이있는 패키지 포함 하위패키지가 탐색 위치 범위이다.
- 그래서 스프링부트의 대표 시작정보인 `@SpringBootApplication`애너테이션도 안에 `@ComponentScan`이있는데 default로 탐색위치 범위가 해당 패키지 포함 하위패키지이다.
- 그래서 어플리케이션 대표설정정보같은 파일은 (스프링 부트에서 `@SpringBootApplication`애너테이션이 붙은 파일)루트 위치에 두는것이 좋다. 그리고 컴포넌트 스캔 탐색위치를 default로하자.- 관례이다.

# 컴포넌트 스캔 대상

- 기본적으로 컴포넌트 스캔방식의 대상은 `@Component`인데 더있다.(내부에 `@Component`가있는 애너테이션들)

- `@Controller` : 스프링 MVC 컨트롤러에서 사용
- `@Service` : 스프링 비즈니스 로직에서 사용
- `@Repository` : 스프링 데이터 접근 계층에서 사용
- `@Configuration` : 스프링 설정 정보에서 사용.
  (전부 안에 `@Component`에너테이션이있다.)
  (참고로 애너테이션은 상속관계가잇는건아니고 이게가능한건 스프링의 기능이다. - 자바언어의 기능이 아니란 의미이다.)

- 이러한 에너테이션들은 사실 컴포넌트 스캔 대상의 역할만 하는게 아닌 스프링은 부가기능을 제공한다.
- `@Controller` : 스프링 MVC 컨트롤러로 인식
- `@Repository` : 데이터 계층의 예외를 스프링 예외로 변환
- `@Configuration` : 스프링 설정정보로인식, 스프링빈이 싱글톤 유지하도록 추가처리(스프링 빈끼리 의존관계를 설정하며 new를 여러번할수도있는데 이떄 싱글톤 유지하도록 추가처리한다는의미이다. @Configuration없다고 스프링 컨테이너의 스프링 빈들이 무조건 싱글톤으로 유지될수없다는건 절대아니다, 무슨말이냐면 @Configuration없어도 스프링 컨테이너는 싱글톤 컨테이너로 기본적으로 스프링빈 객체를 하나만가지고있는데 스프링빈간의 의존관계 설정중에 의도치않게 `new`연산자가 여러번 호출되어 여러 객체가 생성될수도있다. 이러한 경우 `@Configuration`이 붙으면 스프링이 수동 스프링 빈 설정 자바 클래스의 자식클래스를 만들어 (CGLIB라는..) 스프링 빈 등록할때 싱글톤이 되도록 유지하게 도와준다. 복잡하지만 요약하면 스프링빈 수동 등록중 스프링빈들간의 의존관계 설정할 경우 `new`연산자가 한번 초과해서 연산되면 싱글톤 객체가 아니게되는데 이러한경ㅇ `@Configuration`에너테이션이 있으면 `new`연산자가 호출이 많이되도 스프링컨테이너내의 스프링 빈들이 싱글톤 객체가 되도록 도와준다는 의미이다. 그러므로 `@Configuration`을 붙이자.)
- `@Service` : 특별한처리가없지만 개발자들이 이곳에 비즈니스로직이있다는걸 알수있음(개발자들끼리의 약속 promise~)
