# 생성자주입 이 좋은이유

1. 의존관계 변하지않는 어플리케이션

- 의존관계 주입하는 다양한 방법이있었다. 생성자주입, setter주입, 필드주입, 일반 메서드주입...
- 그중 생성자 주입은 생성자를 통해서 의존관계를 주입받는다.
- 즉, 객체가 생성될떄, (스프링 빈으로 등록할 때) 딱 한번 만 의존관계가 주입되기 때문에 그 이후에는 설정된 의존관계가바뀌질 않는다. 생성자를 통해서 의존관게 주입햇으니..
- 이게 장점이다. 실제로 대부분의 어플리케이션들은 한번 의존관계 설정되면거의 대부분 변경되지않는다. 그러므로 생성자를 통해서 의존관계를 주입받는 생성자주입이 좋다.
- 그러나 예외란 항상 존재한다. 그래서 그경우엔 setter주입을 이용한다.
- setter주입은 public으로 열어두어서 외부에서 의존관계를 막 바꿀수있다. 만약 의존관계가 변경되지 않는 어플리케이션이라면 굳이 setter 주입을 사용할필요는없다. 생성자 주입만 사용하면된다.

2. 순수 자바만으로 단위 테스트시 의존관계 detection이 쉽다.!

- 생성자를 통해서 의존관계 주입받는건 순수 자바만을 이용하는 단위테스트에서 의존관계를 확인하기 편하다.
  코드를보자

```
        OrderServiceImpl orderService = new OrderServiceImpl(memberRepository, new FixDiscountPolicy());
```

- 위 경우는 테스트 코드에서 해당 클래스의 테스트를 위한 경우이다.
- 위에서는 생성자주입을 통해 의존관계를 설정했기에 해당 생성자 매개변수에 아무것도 안주면 컴파일에러뜬다..
- 그런데 setter주입을 사용했을땐(생성자 주입 사용하지 않았을 떈) 어떻게될까?

```
        OrderServiceImpl orderService = new OrderServiceImpl();
```

- 당연히도 이렇게 생성자 매개변수엔 줄 내용이없고 위에서 setXxx 메서드를 통해 의존관계 주입받았을 것이다.
- 그런데 우리 어플은 너무너무나도 단순해서 의존관계를 기억하고있지만 조금만 커지면 어디에 무슨 클래스의 의존관계를 주입해야할지 알기어렵다.
- 특히 테스트시 어떤 의존관계를 가져야하는지 알기위해선 해당 코드를 열어봐야한다.
- 생성자 주입했을 경우엔 해당 클래스 테스트할땐 매개변수에 아무 값도 주지 않으면 컴파일에러가 나서 의존관계 detect하기가 쉬웠던 반면 setter주입은 그렇지않다..

> 컴파일에러는 좋은 에러이다!!!

3. final키워드를 사용할수있다.

- final은 불변의 키워드로 멤버변수에 붙으면 상수를 의미한다.
- 생성자 주입을 이용하면 멤버변수에 final을 붙일수있다. (final이 붙은 멤버변수는 상수여서 변수 선언 즉시 초기화 하는게 맞지만 멤버변수는 생성자를 통해서 값을 초기화할수있다. - 이는 자바 문법이다.)
- final을 이용하면 의존관계 변하지않을때 불변이므로 관리하기도 좋고!! 생성자주입받을 때 실수를 줄일수있다. (컴파일 에러가 나서 알려준다..)

# 정리

- 왠만하면 생성자 주입을 사용하되 만약 어플이 실행 도중에의존관계가 바뀌어야한다면?!?! setter주입을 이용하자. 필드주입은 아애 사용하지말자.
