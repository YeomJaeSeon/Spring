# 요청 바디에 JSON이 담겨서 올때는 이 데이터 어떻게 조회할까? 알아보자.

- 요청온 JSON에 대해서는 객체로 변환해서 사용한다. 그래서 jackson라이브러리의 objectMapper를 이용해서 객체로 변환해주는 작업이 필요하다.(서블릿에서도 이거 사용했다.)
- 그러나 스프링 MVC에서는 메시지 컨버터라는 녀석이 존재해서 알아서 json이 오면 content-type보고 어 ? application/json이네 알았어. 알았어. 객체로 변환해서 주면되지? 라는 미친 자동화작업을 해준다. 일단 단계적으로 스프링 MVC에서 어떻게 바디에 담겨서오는 JSON데이터를 조회하는지 알아보자.

1. 고전방식인 HttpServletRequest의 inputStream을 이용해서 하면된다. 그리고 objectMapper로 객체로 변환해주면된다.

2. 바디에 담겨서오는 String데이터 조회할때 사용했던 `@RequestBody` 파라미터를 이용해도된다. `@RequestBody`는 요청의 바디에있는 데이터를 빼주기떄문에. 그런데 json이므로 객체로 변환해줘야하므로 objectMapper를 사용한다.

3. 근데 파라미터요청때는 `@ModelAttribute`로 객체 자동변환해줬는데 바디에 json담겨서올때는 뭐 이런거없나? 있따! `@RequestBody HelloData data`이런식으로 파라미터 받는 형식을 객체로받으면 메시지 컨버터가 바로 json을 객체로 변환해준다. 이러면 json받을때마다 컨트롤러 내부에서 objectMapper사용안해도된다.!

4. 당연하게 HttpEntity를 사용해도 위와동일하다. HttpEntity사용해도 파라미터형식이 객체이면 메시지 컨버터가 json을 자동으로 객체로변환해준다.

5. 근데 리턴타입이 객체이면? 지금까진 리턴타입 String으로해서 `@ResponseBody`를 이용해서 바디에 데이터 콱넣어서 응답했는데 만약 객체이면? 이것도 메시지컨버터가 자동으로 json으로 다시 변환해준다. (객체로 변환된 객체를 json으로 변환해서 응답 바디에 넣어서 내려줌)

# 리턴타입 객체, 파라미터 객체(@RequestBody) 메시지컨버터 동작과정

1. 요청(바디에 json) : json -> 메시지 컨버터 -> 객체
2. 응답(바디에json) : 객체 -> 메시지 컨버터 -> json

# 지금까지.

지금까진 요청을중심으로 어떤식으로 스프링 MVC컨트롤러에선 받는지알아보았다. 헤더부터해서(파라미터에 다양한 정보를 통해서 헤더 조회가능 특히 `@RequestHeader`)~ 요청과 컨트롤러 매핑하는 `@RequestMapping`과 쿼리파라미터 데이터를 어떻게 받는지(점진적인 과정으로, httpServletReqeust inputStream으로 받는것부터해서 @RequestParam, @ModelAttribute), 그리고 바디에 데이터담겨서올땐 어떻게 애너테이션기반 컨트롤러에서 받는지(파라미터 `@RequestBody`를 통해서, 그리고 `HttpEntity로..`), 그리고 그게 string일때와 json일때는 어떻게받는지(string일떈 `@RequestBody`로 간단하게. 그리고 json일땐 객체로변환해줘야하는데 메시지컨버터가알아서 자동변환해주는 `@RequestBody HelloData data`를 이용해서 json을 객체로변환 등을 알아보았다.

- 결론은 너무 편하다는거다. 너무 스프링 MVC는 자동으로 해주는게 많다. 예를들면 `@ModelAttribute`를 생각해보면 쿼리파라미터를 파싱하고 객체에 넣어주는 작업을 알아서 해주니 써야할 코드도줄어들고 편하기도하다. 그런데 아마 아무것도 모른상태에서 했으면 생략이되어있는거 자체가 어려웠을 거라 생각한다. 이젠 익숙해지자 여러번 해보자.!

- 다음엔 응답 중심으로 어떤식으로 스프링 MVC는 응답 메시지를 만들고 어떻게 데이터를 웹브라우저는 전달하는지를 알아보자.
