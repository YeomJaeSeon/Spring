# 지금까지MVC패턴만으로는 힘들던 공통기능 처리를 위해프론트 컨트롤러 패턴(서블릿)을 이용해서 MVC 프레임워크를 만들고있었다. 그래서 프론트 컨트롤러 서블릿으로 공통기능처리하고 해당 컨트롤러들 호출하는 방식으로 했꼬 두번째는 view를 호출하는데 공통의 로직이 너무많으므로 MyView클래스를 만들어서 코드중복을 줄였다.

# 그런데 form과 list컨트롤러 같은 경우는 아애 httpServletRequest, httpServletResponse같은 servlet기능을 아애사용하지않고있고 save컨트롤러는 요청들어온 쿼리파라미터 데이터만 get하는데 request를 사용하고있다. 후자는 그냥 프론트 컨트롤러 서블릿에서 데이터를 Map에 담아서 save컨트롤러로 전달하면 되겠고.. 아무튼 컨트롤러에서 서블릿 종속성을 없애면 더 좋을거같다. 그러면 테스트코드도 훨깔끔해진다. 그러나 그러면 모델을 새로만들어야함. 각 컨트롤러들에서 서블릿이 없으므로. 그래서 모델과 논리적인 view이름의 멤버변수를 가지고있는 ModelView를 만들어서 각 컨트롤러들에서 서블릿의 종속성을 없애보자. 추가로 논리적인 이름이라는건 물리적인 실제이름이 아닌 이름을 사용하자는 것이고 프론트 컨트롤러 서블릿에서 물리적인 이름으로 변경하는 과정을 추가해보자.

- ModelView를 만들어야하는데 ModelView 객체는 뷰가 사용할 데이터를 담은 모델과 view의 논리적인 이름을 가지고있다.
- 이는 컨트롤러에서 ModelView에 모델을 넣어야한다.
- 컨트롤러는 V2까지 MyView를 리턴했지만 이제부턴 모델과 논리적인이름의 멤버를 가지고있는 ModelView를 리턴한다.
- 프톤트 컨트롤러에서 쿼리 파라미터의 데이터를 save 컨트롤러로 보내야하므로 쿼리파라미터 같은 경우는 프론트 컨트롤러에서 만들어서 Map으로 쿼리파라미터 데이터를 전달한다.
- 과정을 보면서 이해하자.

# V3과정 (컨트롤러들에서 서블릿 종속성 삭제)

1. HTTP 요청
2. 프론트 컨트롤러 서블릿(서블릿 매핑된정보가지고있음) 호출
3. uri와 매핑되는 컨트롤러 호출
4. 해당 컨트롤러는 서블릿 종속성이 아애없으므로 인자로 paramMap을받고 이 인자는 요청에서 들어올때 쿼리파라미터의 데이터가있고 이 paramMap은 서블릿인 프론트 컨트롤러 서블릿이 전달했음. 그리고 해당 컨트롤러는 ModelView를 리턴하고 컨트롤러에서 모델에 넣을 데이터가있으면 데이터넣고 viewName(논리적인)을 설정해서 ModelView 객체를 리턴한다.
5. 프론트 컨트롤러에서는 각 컨트롤러에서 반환한 ModelView 객체를 받는다.
6. viewResolver메서드를 통해서 ModelView객체의 viewName을 무릴적인 이름으로 바꿈과 동시에 MyView객체로 만든다.
7. MyView객체를 통해서 render함수를 호출해서 JSP를 포워딩한다. 이때 중요한건 각 컨트롤러는 서블릿을 사용못하므로 모델이 없는상태임 그래서 각 컨트롤러에서 만든 ModelView의 멤버변수 model(데이터가 있는 모델)을 인자로 request와 response와 함께 render함수를 호출
8. 해당 render함수가 호출(v2때와는 다른 오버로딩 된 메서드이다.)되는데 이떄 JSP는 모델의 데이터를 사용할때 request.getAttribute를 사용하므로 request.setAttribute로 인자로 받은 모델을 매핑하는게 필요함.
9. JSP호출
10. HTTP 응답.

# 복잡함.

- 일단 컨트롤러에서 서블릿 종속성을 삭제하는 과정인 V3는 너무 복잡하다.
- 어렵다.
- 그러나 중요한건 프론트 컨트롤러 서블릿만 복잡해졌다는것. 실제 컨트롤러 form컨트롤러, list, save같은 컨트롤러는 view호출하는 로직도 없고, 서블릿 종속성도없으므로 매우매움 간단해짐. - 이게중요!

# viewResolver

- viewResolver로 논리적인 이름을 실제 물리적인 이름으로 변경하는 과정이 필요한건 변경점을 하나로 모으기 위해서임. 예를 들면 하나의 경로가 변경되면 모든 컨트롤러에서 논리적인 경로를 변경. 그러나 viewResolver를 사용하면 논리적인 이름은 각 컨트롤러들이 가지고있어서 프론트컨트롤러에서 viewResolve메서드만 (물리적인 이름으로 변경하는 메서드이므로) 변경하면 됨. 이렇게 변경점을 하나로 맞추는게 중요하다. 이것이 유지보수를 쉽게만들어줌.
