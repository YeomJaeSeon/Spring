# Jdbc(Java Database Connectivity)를 통해 자바(spring 웹서버)로 데이터베이스에 회원 등록하고 조회할수있다 우린

# 이젠 Spring을 띄워서 (spring 컨테이너) 테스트하는 통합테스트 해보자.

- 그럼 이제 DB에 적용되는 테스트, 통합테스트를 해보자.
- 기존에 하던 테스트는 단위테스트라하는데 이건 뭐 순수 자바이므로 spring이 커넥션한 DB에 접근도할수없으므로.. 어케하면 통합테스트하지?

@SpringBootTest를통해서 가능!!!
이 어노테이션이있으면 테스트할때 스프링 컨테이너를 띄운다. 그냥 스프링자체를 테스트할때 실행한다고 보면됨

MemberServiceIntegrationTest에서 객체를 굳이 새로 생성안하고 spring컨테이너를 띄우므로 memberService라던지 memberRepository를 스프링 컨테이너에 등록되어있는 녀석들을 가져다쓰면된다.

이때 @Autowired DI할때 굳이 생성자 주입으로안하고 필드주입해도된다.
테스트는 단지 테스트만을 위한것이므로 더이상 이 객체들이 활용될곳이없기 때문이다~

```
    @Autowired MemberService memberService;
    @Autowired MemberRepository memberRepository;
```

필드 주입!

- 흠. 그런데 테스트는 테스트 실행할때마다 전에 했던 테스트와 의존성이없어야하며 테스트 들끼리도 의존성이없어야하는데.. DB에 테스트한 데이터가 저장이되는뎅?
- @Transactional을 이용한다.
- 이 어노테이션이 **테스트 케이스**에 붙으면(다른 경우는 해당안됨 꼭 테스트에 붙어야함) DB가 커밋해서 데이터를 반영하는데 이걸 안하고 조인, select다하고나서 롤백해버림. 즉, 데이터를 DB에 반영하지않아버림!
- 즉, 테스트 시작전에 트랜잭션을 시작하고, 테스트 완료후엔 항상 롤백을하여 데이터가 DB에 반영되지않아 DB에 데이터가 남지않는다
  . 그래서 다음 테스트에 영향을 주지 않는다.

# 그럼 전에하던 순수 자바로하던! 단위테스트는 의미없나?

- 실행속도를 비교해보면 단위테스트가 훨씬빠름(spring 컨테이너를 띄우는 통합테스트는 스프링을 띄우닌까 당연히 속도가 더 걸리겠다.)
- 순수한 단위테스트가 통합테스트보다 더 좋은 테스트일 확률이높다.
- 단위단위마다 테스트하는 훈련을하자. (spring 컨테이너 없이 테스트하자.)
- 이게 습관이되어야한다.
- 스프링 컨테이너까지 올려서하는 통합테스트는 테스트 설계가 잘못됐을 확률이 높다.
